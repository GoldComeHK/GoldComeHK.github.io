














<!-- 
      :::    :::       ::::::::::           :::        :::::::::
     :+:    :+:       :+:                :+: :+:      :+:    :+:
    +:+    +:+       +:+               +:+   +:+     +:+    +:+
   +#++:++#++       +#++:++#         +#++:++#++:    +#+    +:+
  +#+    +#+       +#+              +#+     +#+    +#+    +#+
 #+#    #+#       #+#              #+#     #+#    #+#    #+#
###    ###       ##########       ###     ###    #########
-->

<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>促銷鍠 📣 | 金come</title>
    <style>
        body { font-family: Arial, sans-serif;background: linear-gradient(145deg, #a8a8a8, #000000);color: #ecf0f1;padding: 20px; }
        h1 { text-align: center;margin-bottom: 20px;font-size: 2em;text-shadow: 2px 2px 4px gold; }
        .container { max-width: 600px;margin: 0 auto;padding: 20px;border-radius: 12px;background: #2f3030;box-shadow: 4px 4px 8px #767676; }
        label, p { margin: 10px 0 5px; }
        input, textarea, select, button { margin-bottom: 10px;padding: 8px;border-radius: 8px;border: none;outline: none; }
        input, select, textarea { width: 100%; }
        .大鍵 {border-radius: 10px; background: #282828;color: #bdbdbd;box-shadow: inset 25px 25px 50px rgba(139, 139, 139, 0.8);border: 1px solid #686868;font-size: 48px;width: 100%; }
        .大鍵:hover { background: #484949; }
        button { background-color: #000000;color: white;cursor: pointer; }
        button:hover { background-color: #484949; }
        .reply-group { margin-bottom: 15px;position: relative; }
        .delete-btn { position: absolute;right: -15px;top: 35%;transform: translateY(-50%);width: 30px;height: 30px;background-color: #444;color: white;border-radius: 50%;display: flex;align-items: center;justify-content: center;font-size: 16px;padding: 0; }
        .delete-btn:hover { background-color: #777; }
        .reply-container { display: flex;align-items: center;gap: 10px; }
        .reply-inputs { flex-grow: 1; }
        .hidden,#uploadInput,.執行金come { display: none; }
        .執行金come{place-items: center;}

        #執行中請不要關閉網頁 {position: fixed;top: 0;left: 0;width: 100vw;    /* 使用视口单位确保全覆盖 */
            height: 100vh;background: rgba(0, 0, 0, 0.1); /* 改用 rgba 透明度 */
            backdrop-filter: blur(2px);-webkit-backdrop-filter: blur(10px); /* Safari 兼容 */
            z-index: 9999;   /* 确保在最顶层 */
            justify-content: center; /* 水平居中 */
            align-items: center;    /* 垂直居中 */
            justify-content: center;align-items: center;flex-direction: column;display: none;}
        #執行中請不要關閉網頁 h2 {color: white;font-size: 2rem;text-shadow: 0 2px 4px rgba(0,0,0,0.5);}


    </style>

  <!-- ws icon https://www.thinkcmf.com/font/font_awesome/icons.html -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
  <script src="../mokJsapi/a.js">//琪琪修改</script>
  <script src="py/py.js"></script>
  <script src="https://cdn.staticfile.net/translate.js/3.1.7/translate.js">// 翻譯 放最後</script>

</head>
<body>
























<!-- 
  :::::::::::       :::    :::   :::::::::::
     :+:           :+:    :+:       :+:
    +:+            +:+  +:+        +:+
   +#+             +#++:+         +#+
  +#+            +#+  +#+        +#+
 #+#           #+#    #+#       #+#
###           ###    ###       ###
-->
    <samp id="莫生查詢" style="display: none;">莫生我要查詢促銷鍠使用問題</samp>

    <samp id="匯入警告" style="display: none;">匯入設定檔會刪除現時設定！</samp>
    <samp id="設定匯入" style="display: none;">設定檔已成功匯入！</samp>
    <samp id="設定格式錯誤" style="display: none;">檔案格式錯誤或解析失敗</samp>

    <samp id="確定刪除" style="display: none;">確定要刪除這組回覆嗎</samp>
    <samp id="當客戶說" style="display: none;">當客戶說</samp>
    <samp id="自動回覆" style="display: none;">自動回覆</samp>
    <samp id="預設客戶說1" style="display: none;">hi</samp>
    <samp id="預設自動回1" style="display: none;">您好！請問有什麼可以幫您？</samp>
    <samp id="預設客戶說2" style="display: none;">你好</samp>
    <samp id="預設自動回2" style="display: none;">您好，歡迎聯絡客服，請說明您的需求。</samp>
    <samp id="預設客戶說3" style="display: none;">謝謝</samp>
    <samp id="預設自動回3" style="display: none;">不客氣，這是我們應該做的。</samp>







    <!-- 部份0: 基本 -->
    <div id="執行中請不要關閉網頁">
        <h2>執行中請不要關閉網頁...</h2>
    </div>
    <h1>促銷鍠 📣 | <a href="./set.html"><b class="_我司名"></b></a></h1>
    <p class="mokJsApi_copyright">版權</p>

    <div class="container" style="padding: 20px;">
        <iframe width="100%" height="315" src="https://www.youtube.com/embed/dBTxzLg-eFA?si=PTpM-9-b3_jeVNB6" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    </div>










    <div id="促銷鍠Box" class="container" style="padding: 20px;">
        
            <!-- 部份1: 帳號 -->
            <label>請填寫您的手機地區號*</label>
            <input id="區號" type="text" placeholder="例如: 86" title="例如: 86" required>
            <label>請填寫您的 WhatsApp 號碼*</label>
            <input id="WhatsApp號" type="text" placeholder="請填寫WhatsApp號碼" title="請填寫WhatsApp號碼" required>


            <!-- 部份2: 促銷鍠設定 -->
            <label>發出促銷信的gmail*</label>
            <input id="發出促銷信的gmail" type="text" placeholder="請填寫發出促銷信的gmail" title="請填寫發出促銷信的gmail" required>
            <a href="#"><label>gmail的應用程式密碼*</label><b>❔</b></a>
            <input id="gmail的應用程式密碼" type="text" placeholder="請填寫gmail的應用程式密碼" title="請填寫gmail的應用程式密碼" required>
            
            
            <label>促銷間隔天數*</label>
            <input id="促銷間隔天數" value="7" type="number" min="1" step="1" required oninput="this.value = this.value.replace(/[^0-9]/g, '');">
            
            <div id="repliesSelectContainer"> <!-- 这里动态加载 select 或提示 --> </div>
            <label>促銷信內容*</label>
            <textarea id="促銷信內容" placeholder="請編寫促銷信內容..." title="請編寫促銷信內容"></textarea>


            <!-- 部份3: 促銷鍠草稿 -->
            <hr>
            <label>草稿</label>
            <p id="促銷信草稿" class="container"></p>
            <label>自動回覆內容</label>
            <p id="自動回覆內容" class="container"></p>
            <hr>


            <!-- 部份4: 結果 -->
            <textarea id="促銷鍠結果" ></textarea>
            <p id="臨時結果"></p>


            <!-- 部份5: 設定檔 -->
            <samp style="float: right;">
                <button onclick="下載設定檔()">⬇️ 下載設定檔</button>
                <input type="file" id="uploadInput" accept=".json" onchange="上傳設定檔(event)">
                <button onclick="document.getElementById('uploadInput').click()">⬆️ 上傳設定檔</button>
            </samp>        


            <!-- 部份6: _顯示聯莫 -->
            <div id="ContactAKI" class="ContactAKI"><!-- JS _顯示聯莫 --></div>
            <br>

            <!-- 部份7: 執行促銷鍠 -->
            <div class="執行金come">
                <button class="大鍵 執行促銷鍠" title="執行促銷鍠 📣" onclick="執行促銷鍠()">執行促銷鍠 📣</button>
                <h3><a href="./set.html">返回<b class="_我司名"></b></a></h3>
            </div>

            <div class="scroll-top" id="scrollTop" onclick="scrollToTop()">↑</div>

    </div>




















<!-- 
      ::::::::           :::     :::     :::       ::::::::::       :::::::::
    :+:    :+:        :+: :+:   :+:     :+:       :+:              :+:    :+:
   +:+              +:+   +:+  +:+     +:+       +:+              +:+    +:+
  +#++:++#++      +#++:++#++: +#+     +:+       +#++:++#         +#+    +:+
        +#+      +#+     +#+  +#+   +#+        +#+              +#+    +#+
#+#    #+#      #+#     #+#   #+#+#+#         #+#              #+#    #+#
########       ###     ###     ###           ##########       #########
-->
    <script>
        AllData位 = ['區號','WhatsApp號','發出促銷信的gmail','gmail的應用程式密碼', '促銷間隔天數', '促銷鍠客詢select','促銷信內容','促銷鍠結果']
        // loadSaved 自動保存
        function saveToLocalStorage(key, value) {
            localStorage.setItem(key, value);
        }

        function loadFromLocalStorage(key) {
            return localStorage.getItem(key);
        }

        function loadSavedData() {
            AllData位.forEach((field) => {
                const element = document.getElementById(field);
                if (element) {
                    element.value = loadFromLocalStorage(field) || '';
                }
            });
        }

        window.addEventListener('beforeunload', () => {
            AllData位.forEach((field) => {
                saveToLocalStorage(field, document.getElementById(field).value);
            });
        });




















/*
      :::::::::       ::::::::     :::       :::       ::::    :::       :::        ::::::::           :::        :::::::::
     :+:    :+:     :+:    :+:    :+:       :+:       :+:+:   :+:       :+:       :+:    :+:        :+: :+:      :+:    :+:
    +:+    +:+     +:+    +:+    +:+       +:+       :+:+:+  +:+       +:+       +:+    +:+       +:+   +:+     +:+    +:+
   +#+    +:+     +#+    +:+    +#+  +:+  +#+       +#+ +:+ +#+       +#+       +#+    +:+      +#++:++#++:    +#+    +:+
  +#+    +#+     +#+    +#+    +#+ +#+#+ +#+       +#+  +#+#+#       +#+       +#+    +#+      +#+     +#+    +#+    +#+
 #+#    #+#     #+#    #+#     #+#+# #+#+#        #+#   #+#+#       #+#       #+#    #+#      #+#     #+#    #+#    #+#
#########       ########       ###   ###         ###    ####       ########## ########       ###     ###    #########

*/
        // 手動上下載
        function 下載設定檔() {
            const data = AllData位.reduce((obj, field) => {
                const element = document.getElementById(field);
                obj[field] = element ? element.value : '';
                return obj;
            }, {});

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement("a");
            link.href = url;
            link.download = "whatsapp_設定檔.json";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }



        function 上傳設定檔(event) {
            const 設定匯入 = document.getElementById('設定匯入').textContent;
            const 設定格式錯誤 = document.getElementById('設定格式錯誤').textContent;

            const 匯入警告 = document.getElementById('匯入警告').textContent;
            if (!confirm(匯入警告)) {location.reload(); return;}

            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    // 使用 AllData位 自动匹配并导入数据
                    AllData位.forEach(field => {
                        const element = document.getElementById(field);
                        if (element) {
                            element.value = importedData[field] || '';
                        }
                    });

                    alert(設定匯入);
                } catch (error) {
                    alert(設定格式錯誤);
                    console.error("解析错误:", error);
                }
            };
            reader.readAsText(file);
        }






























































/*
      :::::::::       ::::::::::       ::::::::      :::    :::       :::    :::::::::::
     :+:    :+:      :+:             :+:    :+:     :+:    :+:       :+:        :+:
    +:+    +:+      +:+             +:+            +:+    +:+       +:+        +:+
   +#++:++#:       +#++:++#        +#++:++#++     +#+    +:+       +#+        +#+
  +#+    +#+      +#+                    +#+     +#+    +#+       +#+        +#+
 #+#    #+#      #+#             #+#    #+#     #+#    #+#       #+#        #+#
###    ###      ##########       ########       ########        ########## ###
*/
        // 監聽臨時結果元素的變化
        const 臨時結果 = document.getElementById("臨時結果");
        const 促銷鍠結果 = document.getElementById("促銷鍠結果");

        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (臨時結果.innerHTML.trim() !== "") {  // 改用innerHTML



                    // 將<br>轉換為換行符
                    const 格式化內容 = 臨時結果.innerHTML
                        .replace(/<br\s*\/?>/gi, "\n")  // 處理普通<br>
                        .replace(/<\/?[^>]+(>|$)/g, ""); // 移除其他HTML標籤（可選）
                    
                    促銷鍠結果.value = 格式化內容 + "\n" + 促銷鍠結果.value;




                    //臨時結果.innerHTML = ""; // 用innerHTML清空
                }
            });
        });

        // 開始觀察臨時結果元素的子節點和文本內容變化
        observer.observe(臨時結果, {
            childList: true,
            characterData: true,
            subtree: true
        });


        // <textarea> 根据内容自动显示/隐藏
            const resultTextarea = document.getElementById('促銷鍠結果');
        // 内容变化监听函数
        function toggleVisibility() {
            const hasContent = resultTextarea.value.trim().length > 0;
            // 使用 classList 切换样式
            resultTextarea.classList.toggle('hidden', !hasContent);
            document.querySelector('#執行中請不要關閉網頁').style.display = 'none';
        }
        // 事件监听（兼容现代浏览器）
        resultTextarea.addEventListener('input', toggleVisibility);
        resultTextarea.addEventListener('paste', toggleVisibility);  // 处理粘贴操作
        resultTextarea.addEventListener('cut', toggleVisibility);    // 处理剪切操作
        // 初始化检查
        toggleVisibility();
        // 可选：处理页面加载后的动态内容注入
        window.addEventListener('load', function() {
        // 如果通过其他方式加载内容需要再次检查
        toggleVisibility();
        });










        



















































/*
      ::::::::       ::::::::::   :::::::::::   :::::::::::       :::::::::::       ::::    :::       ::::::::
    :+:    :+:      :+:              :+:           :+:               :+:           :+:+:   :+:      :+:    :+:
   +:+             +:+              +:+           +:+               +:+           :+:+:+  +:+      +:+
  +#++:++#++      +#++:++#         +#+           +#+               +#+           +#+ +:+ +#+      :#:
        +#+      +#+              +#+           +#+               +#+           +#+  +#+#+#      +#+   +#+#
#+#    #+#      #+#              #+#           #+#               #+#           #+#   #+#+#      #+#    #+#
########       ##########       ###           ###           ###########       ###    ####       ########
*/

        // 客詢select
        let 對應回覆內容 = ''
        function _客詢select() {
            const container = document.getElementById('repliesSelectContainer');

            const replies = JSON.parse(localStorage.getItem('replies') || '{}');
            const 搵客鍠結果 = localStorage.getItem('搵客鍠結果');


            const 促銷鍠Box = document.getElementById('促銷鍠Box');



            console.log(`replies=${replies}`)
            console.log(`搵客鍠結果=${搵客鍠結果}`)
            // 清空容器
            container.innerHTML = '';

            if (Object.keys(replies).length === 0) {
                // 如果没有数据，显示提示
                促銷鍠Box.innerHTML = '';
                促銷鍠Box.innerHTML = '<p class="大鍵"><a href="./4.html" title="🫱🏾‍🫲🏻 客服鍠：7 × 24 不間斷即時回應客戶查詢，增加專業感與成交率。支援多語言。" >请先到 客服鍠 🫱🏾‍🫲🏻 增加客服自动回复内容</a> </p>';
                return
            } 
            
            if (Object.keys(搵客鍠結果).length === 0) {
                // 如果没有数据，显示提示
                促銷鍠Box.innerHTML = '';
                促銷鍠Box.innerHTML = '<p class="大鍵"><a href="./1.html" title="🔍 搵客鍠：按地區、行業、關鍵字，全天候自動為您搵新客戶。" >请先到 搵客鍠 🔍 獲取客戶聯絡資料</a> </p>';
                return
            }
            
            // 如果有数据，创建 select 元素
            const select = document.createElement('select');
            select.id = '促銷鍠客詢select';  // 添加 ID

            // 遍历 replies 的 key，添加到 select
            Object.keys(replies).forEach(key => {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = key;
                select.appendChild(option);
            });

            // 添加到页面
            const label = document.createElement('label');
            label.textContent = '請選擇回覆關鍵字*'; // 设置标签文字
            container.appendChild(label); // 先添加 label
            container.appendChild(select);

            // 可选：监听选择变化
            select.addEventListener('change', (e) => {
                const selectedKey = e.target.value;
                if (selectedKey) {
                    對應回覆內容 = replies[selectedKey]

                    _促銷鍠草稿();
                }
            });
        }







        function _促銷鍠草稿() {
            // 获取DOM元素
            const 區號B = document.getElementById('區號').value;
            const WhatsApp號B = document.getElementById('WhatsApp號').value;
            const 我ws號 = 區號B + WhatsApp號B

            // 将换行符转换为 <br>，并保留空格（使用HTML实体&nbsp;）
            const promoContent = document.getElementById('促銷信內容').value
                .replace(/\n/g, '<br>')  // 替换换行符
                .replace(/ /g, '&nbsp;'); // 替换空格（可选，如需保留空格）
                
            const querySelect = document.getElementById('促銷鍠客詢select').value;
                
            對應回覆內容 = 對應回覆內容.replace(/\n/g, '<br>')  // 替换换行符
            .replace(/ /g, '&nbsp;'); // 替换空格（可选，如需保留空格）

            // 構建WhatsApp鏈接
            let whatsappLink = '';
            if (我ws號) {
                whatsappLink = `https://wa.me/${我ws號}`;
                if (querySelect) {
                    whatsappLink += `/?text=${querySelect}`;
                }
            }

            // 更新自动回复内容的函数
            document.getElementById('促銷信草稿').innerHTML  = 
                `${promoContent}
                <br><br>
                ${whatsappLink}`;
            document.getElementById('自動回覆內容').innerHTML  = 對應回覆內容;

        }


























/*
      :::::::::      :::    :::       ::::    :::                       ::::::::::       :::    :::       ::::::::::
     :+:    :+:     :+:    :+:       :+:+:   :+:                       :+:              :+:    :+:       :+:
    +:+    +:+     +:+    +:+       :+:+:+  +:+                       +:+               +:+  +:+        +:+
   +#++:++#:      +#+    +:+       +#+ +:+ +#+                       +#++:++#           +#++:+         +#++:++#
  +#+    +#+     +#+    +#+       +#+  +#+#+#                       +#+               +#+  +#+        +#+
 #+#    #+#     #+#    #+#       #+#   #+#+#                       #+#              #+#    #+#       #+#
###    ###      ########        ###    ####       ##########      ##########       ###    ###       ##########

*/

        /* ********************* */
        async function 執行促銷鍠() {
            const 區號 = document.getElementById('區號').value;
            const WhatsApp號 = document.getElementById('WhatsApp號').value;

            const 發出促銷信的gmail = document.getElementById('發出促銷信的gmail').value;
            const gmail的應用程式密碼 = document.getElementById('gmail的應用程式密碼').value;
            const 促銷間隔天數 = document.getElementById('促銷間隔天數').value;

            const 促銷信草稿 = document.getElementById('促銷信草稿').textContent;

            //all客聯 = 搵客鍠結果

            const 要齊料 = [區號, WhatsApp號, 發出促銷信的gmail, gmail的應用程式密碼, 促銷間隔天數, 促銷信草稿];

            if (要齊料.some(x => x == null || x === '')){
                alert(`${x} 沒填寫!`)
                return ;
            }

            // qqqqqqqq 
            const 執行碼 = 促銷.replace("@帳號1181@", `'${區號}','${WhatsApp號}','促銷鍠'`) // _獲取帳號資料 必須
                // 執行的功能要值
                .replace("@促銷gmail@", 發出促銷信的gmail)
                .replace("@gmail應密@", gmail的應用程式密碼)
                .replace("@間隔天@", 促銷間隔天數)
                .replace("@促銷信@", 促銷信草稿)
                .replace("@搵客鍠結果@", 搵客鍠結果)

            navigator.clipboard.writeText(執行碼);
            // py 檢查 剪贴板 轉變執行

            document.querySelector('#執行中請不要關閉網頁').style.display = 'flex';
        }
        /* ********************* */






































/*
          :::        :::    :::       :::::::::::
       :+: :+:      :+:   :+:            :+:
     +:+   +:+     +:+  +:+             +:+
   +#++:++#++:    +#++:++              +#+
  +#+     +#+    +#+  +#+             +#+
 #+#     #+#    #+#   #+#            #+#
###     ###    ###    ###       ###########
*/
        function _翻譯(){ 
            translate.service.use('client.edge'); //設置機器翻譯服務通道，直接客戶端本身，不依賴服務端 。相關說明參考 http://translate.zvo.cn/43086.html
            translate.execute();//進行翻譯 
        }

        // 等待頁面完全加載 
        window.onload = function() {
            // 再顯示按鈕
            document.querySelector('.執行金come').style.display = 'grid';

            _客詢select()
            // 監聽輸入變化
            document.getElementById('促銷信內容').addEventListener('input', _促銷鍠草稿);
        };

        function Start() {
            // 顯示聯莫
            const 聯莫 = ['moksurky@gmail.com','https://wa.me/85264071181/','https://i.meee.com.tw/atcX6QM.png','https://www.instagram.com/moksurky2025/','https://line.me/ti/p/UlSPd7p9zh/','https://www.facebook.com/aki.mok.10/','http://t.me/mokaki/'
            ];
            _翻譯()
            _顯示聯莫(聯莫);
            
            loadSavedData();
        }

        琪琪修改()
    </script>
</body>
</html>